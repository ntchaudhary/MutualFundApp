<!doctype html>
<html lang="en" class="h-100">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
  <meta name="generator" content="Hugo 0.88.1">

  <title>Investment Tracker</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    html,
    body {
      max-width: 100%;
      overflow-x: hidden;
    }

    .dropdown-menu[data-bs-popper] {
        top: 100%;
        left: auto;
        margin-top: .125rem;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>

  <!-- Custom styles for this template -->
  <link href="cover.css" rel="stylesheet">

  <script type="text/javascript">
    function separateNumber(givenNumber, tag_id) 
    {

        nfObject = new Intl.NumberFormat('en-IN');
        output = nfObject.format(givenNumber);

        document.getElementById(tag_id).innerHTML = "â‚¹"+output;
    }

    function deleteEntry(fdID) 
    {
        var txt = "http://127.0.0.1:8000/website/delete/"+fdID;
        let options = {
            method: 'DELETE',
            headers: {
                'Content-Type': 
                    'application/json;charset=utf-8'
            }
        }
        if (confirm("Are you sure you want to delete deposit entry")) 
        {
          let fetchRes = fetch(txt,options);
          fetchRes.then(res =>
            res.json()).then(d => {
              alert(d.message);
            })
          window.location.reload();
        } else {
          window.location.reload();
        }
    }
  </script>
</head>

<body class="d-flex text-center text-white">

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <div class="cover-container d-flex w-100 h-100 mx-auto flex-column">

    <div class="row row-cols-1">

      {% include "/include/navbar.html" %}

      <div class="col bg-black bg-gradient border border-dark">
        <br>
        <h1>Number of deposits - <span class="my-0">{{count}}</span></h1>
        <br><br>
        <div class="row">
          <div class="col">
            <div class="container text-center">
              <div class="row align-items-start">
                <div class="col">
                  <h5>Total Invested</h5>
                </div>
                <div class="col">
                  <h2 id="totalPrinciple">{{totalPrinciple}}</h2>
                </div>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="container text-center">
              <div class="row align-items-start">
                <div class="col">
                  <h5>Accrued Interest</h5>
                </div>
                <div class="col">
                  <h2 id="total_interest_earned">{{total_interest_earned}}</h2>
                </div>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="container text-center">
              <div class="row align-items-start">
                <div class="col">
                  <h5>Matured Deposits</h5>
                </div>
                <div class="col">
                  <h2>{{numberOfMatured}}</h2>
                </div>
              </div>
            </div>
          </div>
          <div class="col">
            <div class="container text-center">
              <div class="row align-items-start">
                <div class="col">
                  <a href="/website/add-deposit" class="btn btn-sm fw-bold bg-white">Add New Deposit</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <script>
          separateNumber('{{totalPrinciple}}','totalPrinciple');
          separateNumber('{{total_interest_earned}}','total_interest_earned');
        </script>
        <br><br>
      </div>

      <div class="col text-black bg-success bg-gradient">
        <div class="row g-5 my-2">
          {% for x in body %}
          <div class="container text-center">
            <div class="row">

              <div class="col-sm-2">
                <h4>{{ x.name }} {{ x.type }}</h4>
                <button onclick="deleteEntry('{{ x.id }}')" class="btn btn-sm fw-bold bg-white">Delete</button>
              </div>

              <div class="col">
                <div class="container text-center">
                  <div class="row align-items-start">
                    <div class="col">
                      <strong>Invested</strong>
                    </div>
                    <div class="col">
                      <p id="{{ x.id }}principle">{{ x.principle }}</p>
                    </div>
                  {% if x.installment %}
                    <div class="col">
                      <strong>Installment</strong>
                    </div>
                    <div class="col">
                      <p id="{{ x.id }}install">{{ x.installment }}</p>
                    </div>
                    <script>
                      separateNumber('{{x.installment}}','{{x.id}}install');
                    </script>
                  {% endif %}
                  </div>
                </div>
              </div>

              <div class="col">
                <div class="container text-center">
                  <div class="row align-items-start">
                    <div class="col">
                      <strong>Maturity</strong>
                    </div>
                    <div class="col">
                      <p id="{{ x.id }}maturity_amount">{{ x.maturity_amount }}</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col">
                <div class="container text-center">
                  <div class="row align-items-start">
                    <div class="col">
                      <strong>Int. Earned</strong>
                    </div>
                    <div class="col">
                      <p id="{{ x.id }}interest_earned">{{ x.interest_earned }}</p>
                    </div>
                  </div>
                </div>
              </div>
              <script>
                separateNumber('{{x.principle}}','{{x.id}}principle');
                separateNumber('{{x.maturity_amount}}','{{x.id}}maturity_amount');
                separateNumber('{{x.interest_earned}}','{{x.id}}interest_earned');
              </script>
              <div class="col">
                <div class="container text-center">

                  <div class="row align-items-start">
                    <div class="col">
                      <strong>Interest Rate</strong>
                    </div>
                    <div class="col">
                      <p>{{ x.rate }}%</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col">
                <div class="container text-center">
                  <div class="row align-items-start">
                    <div class="col">
                      <strong>Duration</strong>
                    </div>
                    <div class="col">
                      <p>{{ x.duration }}</p>
                    </div>
                  </div>

                </div>
              </div>

              <div class="col">
                <div class="container text-center">

                  <div class="row align-items-start">
                    <div class="col">
                      <strong>Start Dt.</strong>
                    </div>
                    <div class="col">
                      <p>{{ x.start_date }}</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col">
                <div class="container text-center">
                  <div class="row align-items-start">
                    <div class="col">
                      <strong>Maturity Dt.</strong>
                    </div>
                    <div class="col">
                      <p>{{ x.maturity_date }}</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="col">
                <div class="container text-center">
                  <div class="row align-items-start">
                    <div class="col">
                      <strong>Matured</strong>
                    </div>
                    <div class="col">
                      <p>{{ x.isMatured }}</p>
                    </div>
                  </div>

                </div>
              </div>

            </div>
          </div>
          <br><br>
          {% endfor %}
        </div>
      </div>

    </div>
  </div>
</body>
</html>
